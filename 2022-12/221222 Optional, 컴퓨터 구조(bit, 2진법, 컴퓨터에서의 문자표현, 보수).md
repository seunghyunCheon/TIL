221222 Optional, 컴퓨터 구조(bit, 2진법, 컴퓨터에서의 문자표현, 보수)
===
TIL (Today I Learned)
===
학습내용
---
- Optional 이해하기
- 컴퓨터 구조 파악하기 

학습한 내용 / 고민하고 해결한 점
---
- Optional
    - Optional내부에서 nil의 장점은 변수 안에 값이 존재하는지 아닌지에 대해 문서주석을 할 필요없이 nil을 작성함으로써 확인할 수 있다는 것이다.
    - 암시적 추출 옵셔널도 옵셔널의 종류이기 때문에 if let 바인딩이 가능하다. 그런데 보통 암시적 추출 옵셔널은 값이 있음을 보장할 때 사용하니 이를 if let 구문에 사용하는 것은 다소 모순점이 있어보인다.
    - 닐 코얼레싱 연산자를 이용해서 딕셔너리에 접근할 때 값이 할당되지는 않는다.<br>
    ```swift
        var dictionary = ["1": 1, "2": 2, "3": 3]
        let four = dictionary[4] ?? 4
        print(dictionary) // ouput: ["1": 1, "2": 2, "3": 3]
    ```
### Optional(12) == 12는 왜 true일까?<br>
==(항등 연산자)의 내부구조는 이렇게 되어있다. 
```swift
static func == (lhs: Wrapped?, rhs: Wrapped?) -> Bool
```
왼쪽과 오른쪽 값은 Wrapped?로 묶여있는 형태기 때문에 Int가 들어오든 Int?가 들어오든 옵셔널 형태로 묶여지는 것이다. 그래서 각각 옵셔널 형태가 되고 이들끼리 비교를 하는 것이기 때문에 판별할 수 있는 것이다. 추가적으로 항등연산자(==)는 Equatable 프로토콜을 따라야 사용할 수 있다.

- 컴퓨터 구조
     - 컴퓨터는 ENIAC -> EDSAC -> 진공관 -> 트랜지스터 -> 집적회로의 순으로 발전되었다.
     - 하버드 구조: 명령어 메모리와 데이터 메모리를 사용하는 아키텍처<br>
명령을 메모리부터 읽는 것과 데이터를 메모리부터 읽는 것이 분리되어있기 때문에 동시에 읽을 수 있다. 이 때문에 속도가 빠르다는 장점이 있지만 물리적으로 메모리를 두 개를 배치해야하기 때문에 비용이 많이들고 복잡하다.<br>
    - 폰노이만 구조: 하나의 메모리만 존재해서 명령어와 데이터를 읽기 때문에 병목 현상이 발생하는 특징이 있다.
    - 최신의 컴퓨터 아키텍처는 하버드의 구조와 폰 노이만 구조를 섞어놓은 모습이다. CPU 내부에는 하버드 아키텍처가, CPU외부에는 폰 노이만 아키텍처를 적용함으로써 CPU의 캐시 메모리 형상에 관여하게되어 매우 빠른 속도를 가질 수 있게된다.
### 32Bit vs 64Bit
2진수를 표현하는 가장 작은 단위이자 데이터를 표현하는 가장 작은 단위를 bit라고 한다. 32bit 컴퓨터 아키텍처는 CPU가 한 번 계산을 할 때 32개의 0과 1의 개수만 처리할 수 있다는 뜻이다. 그럼 64bit 컴퓨터 아키텍처는 64개의 0과 1의 개수를 처리할 수 있다는 말이 된다.<br>
단순히 생각해봤을때 32비트와 33비트는 실제로 2배가 차이기 때문에 64비트와의 차이는 굉장히 많은 성능 차이를 보일 것이다.(64비트를 사용하는 Windows는 16TB의 가상 주소공간이 존재한다)

### 그럼 왜 CPU가 32bit일때는 시스템 메모리 용량을 4GB까지만 쓸 수 있었을까?
```
8bit -> 1Byte
1KB -> 2^10Byte
1MB -> 2^10KB
1GB -> 2^10MB = 2^30Byte
```
위의 데이터 단위를 보면 1GB는 2의 30거듭제곱 바이트이다. 여기에 2의2거듭제곱인 4를 곱하면 2의32거듭제곱이 되고 이는 결국 4GB가 된다.
정리하면 CPU가 32bit라는 말은 4GB라는 말과 같고 이는 한번에 처리할 수 있는(=주소 값의 범위) 것이 4GB라는 말과 같다. 
그렇다면 32bit 컴퓨터는 표현할 수 있는 주소의 한계점이 약 42억개(2^32)정도이고 50억이상의 수는 레지스터의 크기가 42억개밖에 없기 때문에 표현할 수 없게 된다.

### 2진법
컴퓨터과학은 <span style="color: #e83e8c">문제 해결</span>에 대한 학문이다. 문제 해결은 입력을 전달받아 출력을 만들어내는 과정이고 그 과정 가운데 있는 것이 컴퓨터과학이다. 이러한 입력과 출력을 표현하기 위해서 정보를 표현하는 방법에 대한 약속이 필요하다.
컴퓨터에는 10진법처럼 많은 숫자가 있지 않고 오직 0과 1만 존재한다. 이렇게 0과 1로만 표현하는 것을 2진법이라고 하며 이것만으로 숫자, 사칙연산, 사진, 영상, 음악을 표현할 수 있다.
```
10진수 -> 2진수
5 -> 0101
3 -> 0011
9 -> 1001
```

### 문자의 표현
그럼 문자, 이미지 들은 0과 1로 어떻게 표현하는 걸까? 
먼저 문자를 숫자로 표현하는 약속 중 하나로 ASCII(아스키코드)가 있다. 총 128개의 부호로 정의되어있으며 대문자 A부터 Z까지의 수는 아래와 같다.

<img src="https://i.imgur.com/gsQzMPf.png" width="500"/><br>

하지만 아스키코드는 오래전 과거에 정한 것이고, 미국을 중심으로 약속을 정한 것이기 때문에 악센트가 있는 다른나라의 언어나 특이한 언어들을 수용하지 않고 있다. 

그래서 새롭게 나온 것이 Unicode이다. Unicode는 8, 16, 32비트까지 사용하기 때문에 훨씬 더 많은 정보를 표현할 수 있다. 유니코드를 사용하면서 한글, 다른나라 언어, 😪이모티콘 등 다양하게 표현할 수 있게 되었다.

이모티콘은 실제로 125348과 같은 숫자로 이루어져있다. 우리가 친구에게 😂이모티콘을 보낸다고 가정해보자. 그렇다면 스마트폰에서는 다음과 같은 일이 일어난다.
> 이모티콘 클릭 -> 전송 -> 128514가 이진수(1111011000000010)으로 디코딩 -> 친구의 스마트폰에 도착 125348로 인코딩 -> iOS환경에서 125348을 출력 

재밌는 사실은 이모티콘을 표현할때 이모티콘의 색상 또한 0과1로 되어있다는 점이다. 색상은 R(Red), G(Green), B(Blue) 세 개를 조합해서 모든 색상을 표현할 수 있다. 
예시로 이모티콘의 노란색을 표현하고자 한다면 R을 72, G를 73, B를 33만큼 섞어서 노란색을 만들어 내는 것이다. <br>
<img src="https://i.imgur.com/la3iaUe.jpg" width ="500"/><br>
위 색상들은 R,G,B 각각의 위치에서 16진수 두개로 표현되어있다. 이는 8비트에 해당하며 R, G, B 각각 0~255의 정도를 줄 수 있다는 뜻이다.

양수, 문자, 이미지를 표현하는 방법을 알아봤다. 

### 그럼 숫자에서 음수는 어떻게 표현해야할까? 
컴퓨터에서 음수를 표현하는 방법을 세 가지가 존재한다.
1. 부호 비트와 절댓값 방법
2. 1의 보수법
3. 2의 보수법

#### 부호 비트와 절대값 방법
최상위 1비트로 부호로 표현하고 나머지 비트로 해당 정수의 절대값을 표현하는 방법이다. 이 방법의 단점은 +0과 -0이 따로 존재하게 된다는 단점이 있다.

#### 1의 보수법
1의 보수법은 해당 양수의 모든 비트를 반전해서 음수를 표현하는 방법이다. 단순히 NOT연산자만으로 표현할 수 있기에 연산이 매우 간단해진다.<br>
<img src="https://i.imgur.com/30sFb6l.png" width="500"/>

하지만 1의 보수법은 부호 비트와 절대값 방법처럼 +0과 -0이 따로 존재하는 문제점을 가진다.

<img src="https://i.imgur.com/QLRM7Ok.png" width="500"/><br>

#### 2의 보수법
2의 보수법은 1의 보수법에 1을 더해서 음수를 표현하는 방법이다. 이 방법은 두 개의 0을 가지는 문제점을 해결하기 위해 고안되었으며 오버플로우되어 값을 버리는 것이 특징이다.

<img src="https://i.imgur.com/ZZZC6WH.png" width="500"/><br>
이 방법을 사용하면 -0은 2의 보수를 구하는 과정에서 최상위 비트를 초과한 오버플로우가 발생하게 되기에 2의 보수법에서는 단 하나의 0만이 존재하게 된다.
이 때문에 현재 대부분의 시스템에서는 모두 2의 보수법으로 음수를 표현하고 있다.




Reference
---
- [boostcourse - CS50](https://www.boostcourse.org/cs112/lecture/118997?isDesc=false)
- [Apple Developer Documentation (==)](https://developer.apple.com/documentation/swift/optional/==(_:_:)-m6x)
- [32비트 컴퓨터와 64비트 컴퓨터의 차이점](https://thrillfighter.tistory.com/116)
- [음수의 표현](http://www.tcpschool.com/c/c_refer_negativeNumber)
- [64-비트 Windows와 32-비트 Windosw의 메모리/CPU 비교](https://ryuchan.kr/47)
- [디스플레이 색상은 어떻게 만들어질까?](https://news.samsungdisplay.com/24640)

###### tags: `Optional`, `컴퓨터 구조`, `bit`, `2진법`, `보수`, `문자표현`
