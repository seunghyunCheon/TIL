## 230722 DTO는 무엇이고 왜 사용하는 걸까?

스위프트의 코어데이터를 사용할 때 이 엔티티를 뷰에 그대로 적용하기보다는 DTO를 한번 거쳐서 적용하는 것이 유지보수에 좋다는 말에 왜 좋은지 궁금해서 찾아보았다.

우선 DTO는 Data Transfer Object로 프로세스 간에 데이터를 전달하는 용도의 객체이다.
스위프트에서는 Codable을 채택한 객체로 원시데이터를 갖고있는 객체를 의미한다. 

만약 DTO와 도메인모델을 나누지 않고 하나의 객체만으로 직접 뷰에 적용이된다면 어떤 일이 발생할까?

1. 뷰에서 사용하는 프로퍼티를 변경할 때 무수한 데이터를 담은 데이터 객체 속에서 프로퍼티를 찾아 수정해야 한다. 단순히 뷰의 프로퍼티 이름변경이 아니라 데이터 처리 로직을 변경한다면? 역시나 무수한 데이터를 담은 객체 속에서 찾아야 한다. 이는 데이터에 관한 부분과 뷰에 관한 부분 두 개가 있어 단일책임원칙을 위반한다.
2. 화면에 필요없는 데이터를 갖고있는 커다란 객체를 들고다니면 비용이 많이 들어 성능이 저하될 것이다. 

정리하면 비즈니스로직과 데이터로직을 나누어 단일책임원칙을 준수하고 유지보수와 확장에 용이한 코드를 만들기 위해서 DTO를 사용하는 것이다. 

DTO를 나누는 기준에 대해서는 사람마다 다르다. 그 중에서 인프런 김영한님의 답변이 인상깊어 가져와봤다.
> 항상 유지보수에서 가장 문제가 되는 것이 바로 애매한 것입니다.
특히 같은 필드인데, 어떤 경우에는 null이고 어떤 경우에는 값이 있고 이렇게 모호하면 정말 유지보수가 어려워집니다.
그래서 API 응답 스펙이 정해지면 그 필드에 값은 항상 같은 원칙으로 반환되도록 명확하게 설계하는 것이 중요합니다.
클래스를 여러개 만들더라도, 코드가 중복되는 것 처럼 보일지라도, 명확한 것이 훨씬 더 나은 선택이라는 것이지요.
다만 API를 제공할 때 또 모든 케이스에 대응해서 만들면 API 자체가 너무 많아집니다.
그래서 null 값 대신에 실제 값을 채워서 반환하는 API를 제공하는 것이 좋습니다.
예를 들어서 username, age 둘다 제공하는 공통 API 하나를 여러곳에서 사용하도록 제공하는 것이지요.
실무에서 API를 설계할 때 진짜 고민은, 생각보다 너무 복잡하다는 것입니다.
어떻게 보면 제공 단위를 크게 만들어서 모든 데이터를 다 반환하는 API 하나를 만들면 될 것 같지만, 이렇게 너무 공통화해도 유지보수가 어렵고, 성능 이슈가 있습니다. 반대로 너무 각각의 케이스를 대응하도록 만들어도 API 자체가 많아져서 유지보수가 어렵습니다.
이 사이에서 적절한 단위로 API를 설계하고 제공하는 것이 묘미이지요^^!
제가 선호하는 방법은 기본 공통 API를 제공하고, 이 기본 공통 API로 해결이 안되는 특수한 경우에 한해서 별도의 API를 제공하는 방법을 선호합니다.


처음부터 적당히 크게 만든다음 여러 화면에 쓰일 여러 도메인 모델을 만들고 적용하는 것이 좋을까? 현재화면에 필요한 프로퍼티들로만 구성하여 만든 후에 점차 늘려나가는 것이 좋을까? 아직 DTO설계를 많이해보지않아서 나만의 정답을 찾기는 어렵지만 우선 전자의 선택으로 만들어 볼 예정이다. 무엇이 나쁘고 좋은지는 끝까지 가보면 더 잘 보이니까 말이다.


### 참고문서
- [DTO는 왜, 언제 사용할까?](https://e-una.tistory.com/72)
